<hack>
  <title>Advanced Auto Donation System</title>
  <author>DiemThuy</author>
  <version>1.3</version>

  <file>
     <name>"database"</name>

        <operation>
      <action>"sql"</action>
      <data><![CDATA[CREATE TABLE `{$db_prefix}donors` (
  `id` int(6) unsigned NOT NULL auto_increment,
  `userid` varchar(20) NOT NULL,
  `first_name` varchar(255) NOT NULL default '',
  `last_name` varchar(255) NOT NULL default '',
  `payers_email` varchar(255) NOT NULL default '',
  `mc_gross` decimal(5,2) NOT NULL,
  `date` datetime default '0000-00-00 00:00:00',
  `country` varchar(255) NOT NULL,
  `item` varchar(20) NOT NULL,
  UNIQUE KEY `id` (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
]]></data>
    </operation>
    		<operation>
			<action>"sql"</action>
			<data><![CDATA[CREATE TABLE `{$db_prefix}paypal_settings` (
  `id` varchar(60) NOT NULL default '',
  `test` enum('true','false') NOT NULL default 'true',
  `paypal_email` varchar(60) NOT NULL default '',
  `sandbox_email` varchar(60) NOT NULL default '',
  `vip_days` varchar(60) NOT NULL default '',
  `vip_rank` varchar(60) NOT NULL default '',
  `needed` varchar(60) NOT NULL default '',
  `due_date` varchar(60) NOT NULL default '',
  `num_block` varchar(60) NOT NULL default '',
  `received` varchar(60) NOT NULL default '',
  `donation_block` enum('true','false') NOT NULL default 'true',
  `scrol_tekst` varchar(255) NOT NULL default '',
  `units` enum('true','false') NOT NULL default 'true',
  `historie` enum('true','false') NOT NULL default 'true',
  `don_star` enum('true','false') NOT NULL default 'true',
  `gb` varchar(60) NOT NULL default '',
  `smf` varchar(60) NOT NULL default ''
) ENGINE=MyISAM DEFAULT CHARSET=latin1 ;]]></data>
		</operation>
		    		<operation>
			<action>"sql"</action>
			<data><![CDATA[INSERT INTO `{$db_prefix}paypal_settings` (`id`,`test`, `paypal_email`, `sandbox_email`, `vip_days`, `vip_rank`, `needed`, `due_date`, `num_block`, `received`, `donation_block`, `scrol_tekst`, `units`, `historie`, `don_star`, `gb`, `smf`)VALUES ('1','true', 'email', 'email','1', '1','1','10/09/09','1','1','1','tekst','true','true','true',1,1);]]></data>
		</operation>


</file>
    <!-- edit admin.index.php -->
    <file>
        <name>"$DEFAULT_ROOT/admin/admin.index.php"</name>
        <operation>
            <search><![CDATA[case 'users':
      include("$ADMIN_PATH/admin.users.tools.php");
      $tpl->set("main_content",set_block($block_title,"center",$admintpl->fetch(load_template("admin.users.tools.tpl"))));
      break;]]></search>
            <action>"add"</action>
            <data><![CDATA[
          case 'donate':
          include("$ADMIN_PATH/admin.donate.php");
          $tpl->set("main_content",set_block($language["ACP_DONATE"],"center",$admintpl->fetch(load_template("admin.donate.tpl"))));
          break;
      ]]></data>
            <where>"after"</where>
        </operation>
    </file>

    <!-- edit admin.menu.php -->
    <file>
        <name>"$DEFAULT_ROOT/admin/admin.menu.php"</name>
        <operation>
            <search><![CDATA["description"=>$language["ACP_DBUTILS"]),]]></search>
            <action>"add"</action>
            <data><![CDATA[
                     11=>array(
                    "url"=>"index.php?page=admin&amp;user=".$CURUSER["uid"]."&amp;code=".$CURUSER["random"]."&amp;do=donate" ,
                    "description"=>$language["ACP_DONATE"]) ,
                    ]]></data>
      <where>"after"</where>
        </operation>
    </file>
    

          <!-- edit userdetails.php -->
    <file>
        <name>"$DEFAULT_ROOT/userdetails.php"</name>
                <operation>
            <search><![CDATA[$res=get_result("SELECT]]></search>
            <action>"add"</action>
            <data><![CDATA[ u.rank_switch, ]]></data>
      <where>"after"</where>
        </operation>
        <operation>
            <search><![CDATA[$userdetailtpl -> set("userdetail_lastaccess", ($row["lastconnect"]==0 ? "N/A" : get_date_time($row["lastconnect"])));]]></search>
            <action>"add"</action>
            <data><![CDATA[
$userdetailtpl -> set("timed_rank_header", ($row["rank_switch"]=="no" ? "" : "<tr><td class=header>Timed Rank Expire"));
$userdetailtpl -> set("timed_rank_title", ($row["rank_switch"]=="no" ? "" : "<td class=lista colspan=2 ><font color = red><b>".unesc($row["timed_rank"]."</b></font></tr>")));
                    ]]></data>
      <where>"before"</where>
        </operation>
    </file>
            <!-- edit userdetails.tpl -->
    <file>
    <name>"$DEFAULT_STYLE_PATH/userdetails.tpl"</name>
    <operation>
      <search><![CDATA[</if:userdetail_edit_admin>]]></search>
      <action>"add"</action>
      <where>"after"</where>
      <data><![CDATA[
    <tag:timed_rank_header /></td>

    <tag:timed_rank_title /></td>
      ]]></data>
    </operation>
  </file>
    
        <!-- edit index.php -->
    <file>
        <name>"$DEFAULT_ROOT/index.php"</name>
        <operation>
            <search><![CDATA[case 'torrents':]]></search>
            <action>"add"</action>
            <data><![CDATA[
        case 'donate':
        require("$THIS_BASEPATH/pp.php");
        $tpl->set("main_content",set_block($language["DONATE"],"center",$pptpl->fetch(load_template("pp.tpl"))));
        $tpl->set("main_title",$btit_settings["name"]." .::. "."Index->Donate");
        break;
                    ]]></data>
      <where>"before"</where>
        </operation>
    </file>
     <!-- edit functions.php -->
    <file>
    <name>"$DEFAULT_ROOT/include/functions.php"</name>
    <operation>
      <search><![CDATA[function dbconn($do_clean=false) {]]></search>
      <action>"add"</action>
      <where>"before"</where>
      <data><![CDATA[
      function rank_expiration_dt($timestamp=0)
{return gmdate('Y-m-d H:i:s',$timestamp);}
]]></data>
    </operation>
	</file>

<!-- edit 2 language files .php -->

    <file>
        <name>"$DEFAULT_LANGUAGE_PATH/lang_admin.php"</name>
        <operation>
            <search><![CDATA[?>]]></search>
            <action>"add"</action>
            <data><![CDATA[
$language['ACP_DONATE']='VIP & Donate Settings';
]]></data>
            <where>"before"</where>
        </operation>
        </file>
            <file>
        <name>"$DEFAULT_LANGUAGE_PATH/lang_main.php"</name>
        <operation>
            <search><![CDATA[?>]]></search>
            <action>"add"</action>
            <data><![CDATA[
$language["DONATE"]="Make a Donation";
]]></data>
            <where>"before"</where>
        </operation>
        </file>
        
        <!-- copy the 2 template files -->
    <file>
        <name>"$CURRENT_FOLDER/admin.donate.tpl"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_STYLE_PATH"</where>
            <data>"admin.donate.tpl"</data>
        </operation>
    </file>
        <file>
        <name>"$CURRENT_FOLDER/pp.tpl"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_STYLE_PATH"</where>
            <data>"pp.tpl"</data>
        </operation>
    </file>


<!-- copy the other 4 files  -->

    <file>
        <name>"$CURRENT_FOLDER/admin.donate.php"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/admin"</where>
            <data>"admin.donate.php"</data>
        </operation>
    </file>

   <file>
        <name>"$CURRENT_FOLDER/paypal.php"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/"</where>
            <data>"paypal.php"</data>
        </operation>
    </file>

    <file>
        <name>"$CURRENT_FOLDER/pp.php"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/"</where>
            <data>"pp.php"</data>
        </operation>
    </file>

    <file>
        <name>"$CURRENT_FOLDER/paypal_block.php"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/blocks"</where>
            <data>"paypal_block.php"</data>
        </operation>
    </file>

    <!-- copy the other 7 images  -->
    
        <file>
        <name>"$CURRENT_FOLDER/donate.gif"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/images"</where>
            <data>"donate.gif"</data>
        </operation>
    </file>

    <file>
        <name>"$CURRENT_FOLDER/progress-0.gif"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/images"</where>
            <data>"progress-0.gif"</data>
        </operation>
    </file>

        <file>
        <name>"$CURRENT_FOLDER/progress-1.gif"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/images"</where>
            <data>"progress-1.gif"</data>
        </operation>
    </file>

        <file>
        <name>"$CURRENT_FOLDER/progress-2.gif"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/images"</where>
            <data>"progress-2.gif"</data>
        </operation>
    </file>

            <file>
        <name>"$CURRENT_FOLDER/progress-3.gif"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/images"</where>
            <data>"progress-3.gif"</data>
        </operation>
    </file>

            <file>
        <name>"$CURRENT_FOLDER/progress-4.gif"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/images"</where>
            <data>"progress-4.gif"</data>
        </operation>
    </file>

            <file>
        <name>"$CURRENT_FOLDER/progress-5.gif"</name>
        <operation>
            <action>"copy"</action>
            <where>"$DEFAULT_ROOT/images"</where>
            <data>"progress-5.gif"</data>
        </operation>
    </file>
</hack>
